<html><head><base href="https://websim.creativeengine.ai/image-gallery/">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÁÖßÁâáÁÆ°ÁêÜ</title>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #fff;
    }
    .container {
        max-width: 100%;
        padding: 10px;
        padding-bottom: 70px;
    }
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
        background-color: #f8f8f8;
        border-bottom: 1px solid #e0e0e0;
        position: sticky;
        top: 0;
        z-index: 100;
    }
    .header h1 {
        font-size: 17px;
        font-weight: 600;
        margin: 0;
    }
    .header-icons {
        display: flex;
        align-items: center;
    }
    .device-icon {
        font-size: 20px;
        color: #8e8e93;
        margin-left: 15px;
        cursor: pointer;
    }
    .device-icon.active {
        color: #007AFF;
    }
    .search-icon, .more-icon {
        font-size: 20px;
        color: #007AFF;
        margin-left: 15px;
    }
    .month-group {
        margin-bottom: 20px;
    }
    .month-title {
        font-size: 17px;
        font-weight: 600;
        margin: 15px 0 10px 15px;
        color: #000;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .month-select {
        width: 20px;
        height: 20px;
        border: 2px solid #007AFF;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-right: 15px;
    }
    .month-select.selected::after {
        content: '';
        width: 12px;
        height: 12px;
        background-color: #007AFF;
        border-radius: 50%;
    }
    .image-grid {
        display: grid;
        gap: 2px;
        grid-template-columns: repeat(3, 1fr);
    }
    .image-grid.mobile {
        grid-template-columns: repeat(3, 1fr);
    }
    .image-grid.tablet {
        grid-template-columns: repeat(6, 1fr);
    }
    .image-grid.desktop {
        grid-template-columns: repeat(9, 1fr);
    }
    .image-item {
        position: relative;
        aspect-ratio: 1;
    }
    .image-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .video-indicator {
        position: absolute;
        bottom: 5px;
        right: 5px;
        background-color: rgba(0,0,0,0.5);
        color: white;
        padding: 2px 5px;
        border-radius: 2px;
        font-size: 12px;
    }
    .selection-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.5);
        display: none;
    }
    .selection-indicator {
        position: absolute;
        top: 5px;
        right: 5px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 2px solid white;
        background-color: #007AFF;
        display: none;
    }
    .tab-bar {
        display: flex;
        justify-content: space-around;
        background-color: #f8f8f8;
        border-top: 1px solid #e0e0e0;
        padding: 10px 0;
        position: fixed;
        bottom: 0;
        width: 100%;
        z-index: 100;
    }
    .tab-item {
        text-align: center;
        font-size: 10px;
        color: #8e8e93;
    }
    .tab-item.active {
        color: #007AFF;
    }
    .select-button {
        position: fixed;
        bottom: 60px;
        right: 20px;
        background-color: #007AFF;
        color: white;
        border: none;
        border-radius: 20px;
        padding: 10px 20px;
        font-size: 16px;
        display: none;
        z-index: 101;
    }
    .fullscreen-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }
    .fullscreen-image {
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
    }
    .close-fullscreen {
        position: absolute;
        top: 20px;
        right: 20px;
        color: white;
        font-size: 30px;
        cursor: pointer;
    }
    .loading {
        text-align: center;
        padding: 20px;
        color: #8e8e93;
    }
</style>
</head>
<body>
    <div class="header">
        <h1>ÁÖßÁâá</h1>
        <div class="header-icons">
            <span class="device-icon" id="mobileIcon">üì±</span>
            <span class="device-icon" id="tabletIcon">üìü</span>
            <span class="device-icon active" id="desktopIcon">üíª</span>
            <span class="search-icon">üîç</span>
            <span class="more-icon">‚ãØ</span>
        </div>
    </div>

    <div class="container" id="gallery"></div>

    <button class="select-button" id="selectButton">ÂÆåÊàê</button>

    <div class="tab-bar">
        <div class="tab-item active">
            <div>üñºÔ∏è</div>
            ÁÖßÁâá
        </div>
        <div class="tab-item">
            <div>üóÇÔ∏è</div>
            Áõ∏Á∞ø
        </div>
        <div class="tab-item">
            <div>üîç</div>
            ÊêúÁ¥¢
        </div>
        <div class="tab-item">
            <div>üë§</div>
            ÊàëÁöÑ
        </div>
    </div>

    <div class="fullscreen-overlay" id="fullscreenOverlay">
        <span class="close-fullscreen" onclick="closeFullscreen()">√ó</span>
        <img src="" alt="Full screen image" class="fullscreen-image" id="fullscreenImage">
    </div>

    <script>
        const gallery = document.getElementById('gallery');
        const selectButton = document.getElementById('selectButton');
        const fullscreenOverlay = document.getElementById('fullscreenOverlay');
        const fullscreenImage = document.getElementById('fullscreenImage');
        const mobileIcon = document.getElementById('mobileIcon');
        const tabletIcon = document.getElementById('tabletIcon');
        const desktopIcon = document.getElementById('desktopIcon');
        let isSelectionMode = false;
        let selectedImages = new Set();
        let selectedMonths = new Set();
        let page = 1;
        let isLoading = false;
        let currentDevice = 'desktop';

        const getImages = (page) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const images = [
                        { id: (page-1)*9+1, src: `https://picsum.photos/id/${(page-1)*9+1}/300/300`, date: '2023-07-31', type: 'image' },
                        { id: (page-1)*9+2, src: `https://picsum.photos/id/${(page-1)*9+2}/300/300`, date: '2023-07-30', type: 'video', duration: '00:20' },
                        { id: (page-1)*9+3, src: `https://picsum.photos/id/${(page-1)*9+3}/300/300`, date: '2023-07-30', type: 'image' },
                        { id: (page-1)*9+4, src: `https://picsum.photos/id/${(page-1)*9+4}/300/300`, date: '2023-06-30', type: 'video', duration: '01:33' },
                        { id: (page-1)*9+5, src: `https://picsum.photos/id/${(page-1)*9+5}/300/300`, date: '2023-06-30', type: 'image' },
                        { id: (page-1)*9+6, src: `https://picsum.photos/id/${(page-1)*9+6}/300/300`, date: '2023-06-30', type: 'image' },
                        { id: (page-1)*9+7, src: `https://picsum.photos/id/${(page-1)*9+7}/300/300`, date: '2023-05-30', type: 'video', duration: '00:56' },
                        { id: (page-1)*9+8, src: `https://picsum.photos/id/${(page-1)*9+8}/300/300`, date: '2023-05-30', type: 'image' },
                        { id: (page-1)*9+9, src: `https://picsum.photos/id/${(page-1)*9+9}/300/300`, date: '2023-05-30', type: 'image' },
                    ];
                    resolve(images);
                }, 1000);
            });
        };

        const renderImages = (images) => {
            const groupedImages = groupImagesByMonth(images);
            
            for (const [month, monthImages] of Object.entries(groupedImages)) {
                let monthGroup = document.querySelector(`.month-group[data-month="${month}"]`);
                if (!monthGroup) {
                    monthGroup = document.createElement('div');
                    monthGroup.className = 'month-group';
                    monthGroup.dataset.month = month;
                    
                    const monthTitle = document.createElement('h2');
                    monthTitle.className = 'month-title';
                    monthTitle.innerHTML = `
                        ${month}
                        <div class="month-select" data-month="${month}"></div>
                    `;
                    monthGroup.appendChild(monthTitle);
                    
                    const imageGrid = document.createElement('div');
                    imageGrid.className = `image-grid ${currentDevice}`;
                    monthGroup.appendChild(imageGrid);
                    
                    gallery.appendChild(monthGroup);

                    const monthSelect = monthTitle.querySelector('.month-select');
                    monthSelect.addEventListener('click', (e) => {
                        e.stopPropagation();
                        toggleMonthSelection(month);
                    });
                }
                
                const imageGrid = monthGroup.querySelector('.image-grid');
                imageGrid.innerHTML = ''; // Clear existing images
                const imagesToShow = getImagesToShow(monthImages);
                imagesToShow.forEach(image => {
                    const imageItem = createImageItem(image);
                    imageGrid.appendChild(imageItem);
                });
            }
        };

        const getImagesToShow = (images) => {
            switch (currentDevice) {
                case 'mobile':
                    return images.slice(0, 3);
                case 'tablet':
                    return images.slice(0, 6);
                case 'desktop':
                    return images.slice(0, 9);
                default:
                    return images.slice(0, 9);
            }
        };

        const groupImagesByMonth = (images) => {
            return images.reduce((groups, image) => {
                const date = new Date(image.date);
                const month = date.toLocaleString('default', { month: 'long', year: 'numeric' });
                if (!groups[month]) {
                    groups[month] = [];
                }
                groups[month].push(image);
                return groups;
            }, {});
        };

        const createImageItem = (image) => {
            const imageItem = document.createElement('div');
            imageItem.className = 'image-item';
            imageItem.dataset.id = image.id;
            
            const img = document.createElement('img');
            img.src = image.src;
            img.alt = `Image ${image.id}`;
            imageItem.appendChild(img);
            
            if (image.type === 'video') {
                const videoIndicator = document.createElement('div');
                videoIndicator.className = 'video-indicator';
                videoIndicator.textContent = image.duration;
                imageItem.appendChild(videoIndicator);
            }

            const selectionOverlay = document.createElement('div');
            selectionOverlay.className = 'selection-overlay';
            imageItem.appendChild(selectionOverlay);

            const selectionIndicator = document.createElement('div');
            selectionIndicator.className = 'selection-indicator';
            imageItem.appendChild(selectionIndicator);

            let clickTimer = null;

            imageItem.addEventListener('click', (e) => {
                if (currentDevice === 'desktop') {
                    if (clickTimer === null) {
                        clickTimer = setTimeout(() => {
                            clickTimer = null;
                            toggleSelection(image.id, selectionOverlay, selectionIndicator);
                        }, 200);
                    } else {
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        openFullscreen(image.src);
                    }
                } else {
                    if (isSelectionMode) {
                        toggleSelection(image.id, selectionOverlay, selectionIndicator);
                    } else {
                        openFullscreen(image.src);
                    }
                }
            });

            if (currentDevice !== 'desktop') {
                imageItem.addEventListener('long-press', (e) => {
                    if (!isSelectionMode) {
                        isSelectionMode = true;
                        selectButton.style.display = 'block';
                    }
                    toggleSelection(image.id, selectionOverlay, selectionIndicator);
                });
            }
            
            return imageItem;
        };

        const toggleSelection = (id, overlay, indicator) => {
            if (!isSelectionMode) {
                isSelectionMode = true;
                selectButton.style.display = 'block';
            }

            if (selectedImages.has(id)) {
                selectedImages.delete(id);
                overlay.style.display = 'none';
                indicator.style.display = 'none';
            } else {
                selectedImages.add(id);
                overlay.style.display = 'block';
                indicator.style.display = 'block';
            }

            updateSelectButtonText();
        };

        const toggleMonthSelection = (month) => {
            const monthGroup = document.querySelector(`.month-group[data-month="${month}"]`);
            const monthSelect = monthGroup.querySelector('.month-select');
            const imageItems = monthGroup.querySelectorAll('.image-item');

            if (selectedMonths.has(month)) {
                selectedMonths.delete(month);
                monthSelect.classList.remove('selected');
                imageItems.forEach(item => {
                    selectedImages.delete(item.dataset.id);
                    item.querySelector('.selection-overlay').style.display = 'none';
                    item.querySelector('.selection-indicator').style.display = 'none';
                });
            } else {
                selectedMonths.add(month);
                monthSelect.classList.add('selected');
                imageItems.forEach(item => {
                    selectedImages.add(item.dataset.id);
                    item.querySelector('.selection-overlay').style.display = 'block';
                    item.querySelector('.selection-indicator').style.display = 'block';
                });
            }

            updateSelectButtonText();
        };

        const updateSelectButtonText = () => {
            selectButton.textContent = selectedImages.size > 0 ? `ÂÆåÊàê (${selectedImages.size})` : 'ÂÆåÊàê';
        };

        selectButton.addEventListener('click', () => {
            console.log('Selected images:', Array.from(selectedImages));
            // Here you can implement what happens when selection is complete
            isSelectionMode = false;
            selectedImages.clear();
            selectedMonths.clear();
            selectButton.style.display = 'none';
            document.querySelectorAll('.selection-overlay, .selection-indicator').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.month-select').forEach(el => el.classList.remove('selected'));
        });

        const openFullscreen = (src) => {
            fullscreenImage.src = src;
            fullscreenOverlay.style.display = 'flex';
        };

        const closeFullscreen = () => {
            fullscreenOverlay.style.display = 'none';
        };

        const loadMoreImages = async () => {
            if (isLoading) return;
            isLoading = true;

            const loadingIndicator = document.createElement('div');
            loadingIndicator.className = 'loading';
            loadingIndicator.textContent = 'Ê≠£Âú®Âä†ËΩΩÊõ¥Â§ö...';
            gallery.appendChild(loadingIndicator);

            try {
                const newImages = await getImages(page);
                renderImages(newImages);
                page++;
            } catch (error) {
                console.error('Error loading images:', error);
            } finally {
                isLoading = false;
                gallery.removeChild(loadingIndicator);
            }
        };

        const changeDevice = (device) => {
            currentDevice = device;
            document.querySelectorAll('.device-icon').forEach(icon => icon.classList.remove('active'));
            document.getElementById(`${device}Icon`).classList.add('active');
            document.querySelectorAll('.image-grid').forEach(grid => {
                grid.className = `image-grid ${device}`;
            });
            renderImages([]); // Re-render images with new device setting
        };

        mobileIcon.addEventListener('click', () => changeDevice('mobile'));
        tabletIcon.addEventListener('click', () => changeDevice('tablet'));
        desktopIcon.addEventListener('click', () => changeDevice('desktop'));

        // ÂàùÂßãÂä†ËΩΩ
        loadMoreImages();

        // ÊªöÂä®Âä†ËΩΩ
        window.addEventListener('scroll', () => {
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500) {
                loadMoreImages();
            }
        });

        // ÈïøÊåâ‰∫ã‰ª∂Â§ÑÁêÜÔºà‰ªÖÁî®‰∫éÁßªÂä®ÂíåÂπ≥ÊùøËÆæÂ§áÔºâ
        let timer;
        document.addEventListener('touchstart', (e) => {
            if (currentDevice !== 'desktop') {
                timer = setTimeout(() => {
                    e.target.dispatchEvent(new Event('long-press'));
                }, 500);
            }
        });

        document.addEventListener('touchend', () => {
            clearTimeout(timer);
        });

        document.addEventListener('touchmove', () => {
            clearTimeout(timer);
        });
    </script>
</body>
</html>